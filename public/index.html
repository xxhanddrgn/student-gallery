<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ìš°ë¦¬ ë°˜ ê°¤ëŸ¬ë¦¬</title>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --primary: #6c63ff;
      --primary-light: #ede9ff;
      --accent: #ff6584;
      --bg: #f4f6fb;
      --card: #ffffff;
      --text: #2d2d3a;
      --muted: #888;
      --border: #e3e6f0;
      --radius: 16px;
      --shadow: 0 4px 24px rgba(108,99,255,.10);
    }

    body {
      font-family: 'Segoe UI', 'Apple SD Gothic Neo', sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
    }

    /* â”€â”€ Header â”€â”€ */
    header {
      background: linear-gradient(135deg, var(--primary) 0%, #9b8fff 100%);
      color: #fff;
      padding: 28px 24px 20px;
      text-align: center;
      box-shadow: 0 2px 12px rgba(108,99,255,.25);
    }
    header h1 { font-size: 2rem; font-weight: 800; letter-spacing: -0.5px; }
    header p  { margin-top: 6px; font-size: .95rem; opacity: .85; }

    /* â”€â”€ Upload section â”€â”€ */
    .upload-section {
      max-width: 680px;
      margin: 32px auto 0;
      padding: 0 16px;
    }

    .upload-card {
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 28px 28px 24px;
    }
    .upload-card h2 { font-size: 1.15rem; font-weight: 700; margin-bottom: 20px; color: var(--primary); }

    .form-row { display: flex; gap: 12px; flex-wrap: wrap; margin-bottom: 16px; }
    .form-row .field { flex: 1; min-width: 160px; }

    label { display: block; font-size: .82rem; font-weight: 600; color: var(--muted); margin-bottom: 6px; letter-spacing: .3px; text-transform: uppercase; }

    input[type="text"], textarea {
      width: 100%;
      border: 1.5px solid var(--border);
      border-radius: 10px;
      padding: 10px 14px;
      font-size: .97rem;
      color: var(--text);
      background: var(--bg);
      transition: border-color .2s;
      font-family: inherit;
    }
    input[type="text"]:focus, textarea:focus {
      outline: none;
      border-color: var(--primary);
      background: #fff;
    }
    textarea { resize: vertical; min-height: 70px; }

    /* Drop zone */
    .drop-zone {
      border: 2.5px dashed #c5bff8;
      border-radius: 12px;
      background: var(--primary-light);
      padding: 32px 20px;
      text-align: center;
      cursor: pointer;
      transition: border-color .2s, background .2s;
      margin-bottom: 16px;
      position: relative;
    }
    .drop-zone:hover, .drop-zone.over { border-color: var(--primary); background: #e4deff; }
    .drop-zone input[type="file"] { position: absolute; inset: 0; opacity: 0; cursor: pointer; }
    .drop-zone .dz-icon { font-size: 2.4rem; margin-bottom: 8px; }
    .drop-zone .dz-text { font-size: .93rem; color: var(--primary); font-weight: 600; }
    .drop-zone .dz-sub  { font-size: .8rem; color: var(--muted); margin-top: 4px; }

    #preview-wrap { margin-bottom: 16px; display: none; }
    #preview-wrap img {
      max-height: 220px;
      border-radius: 10px;
      border: 2px solid var(--border);
      display: block;
      margin: 0 auto;
      object-fit: cover;
      max-width: 100%;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      border: none;
      border-radius: 10px;
      padding: 11px 24px;
      font-size: .97rem;
      font-weight: 700;
      cursor: pointer;
      transition: transform .15s, box-shadow .15s, opacity .15s;
    }
    .btn:hover { transform: translateY(-1px); box-shadow: 0 6px 18px rgba(0,0,0,.12); }
    .btn:active { transform: translateY(0); }
    .btn-primary { background: var(--primary); color: #fff; width: 100%; justify-content: center; font-size: 1rem; padding: 13px; }
    .btn-primary:disabled { opacity: .5; cursor: not-allowed; transform: none; box-shadow: none; }

    /* Loading spinner */
    .spinner {
      display: inline-block; width: 18px; height: 18px;
      border: 2.5px solid rgba(255,255,255,.4);
      border-top-color: #fff;
      border-radius: 50%;
      animation: spin .7s linear infinite;
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    /* â”€â”€ Gallery â”€â”€ */
    .gallery-section { max-width: 1100px; margin: 36px auto 60px; padding: 0 16px; }
    .gallery-section h2 { font-size: 1.25rem; font-weight: 800; margin-bottom: 20px; }
    .gallery-section h2 span { color: var(--primary); }

    .gallery-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 24px;
    }

    .post-card {
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      transition: transform .2s, box-shadow .2s;
    }
    .post-card:hover { transform: translateY(-4px); box-shadow: 0 12px 32px rgba(108,99,255,.15); }

    .post-img-wrap { position: relative; padding-top: 70%; overflow: hidden; background: #f0f0f5; }
    .post-img-wrap img {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform .3s;
    }
    .post-card:hover .post-img-wrap img { transform: scale(1.04); }

    .post-body { padding: 16px 18px 12px; flex: 1; display: flex; flex-direction: column; }

    .post-meta { display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px; }
    .post-author {
      display: inline-flex; align-items: center; gap: 6px;
      font-size: .83rem; font-weight: 700; color: var(--primary);
      background: var(--primary-light); border-radius: 20px; padding: 3px 10px;
    }
    .post-author::before { content: 'ğŸ‘¤'; font-size: .9rem; }
    .post-date { font-size: .78rem; color: var(--muted); }

    .post-title { font-size: 1.03rem; font-weight: 700; margin-bottom: 6px; }
    .post-desc { font-size: .88rem; color: var(--muted); line-height: 1.5; flex: 1; }

    /* Actions */
    .post-actions {
      display: flex;
      align-items: center;
      gap: 12px;
      border-top: 1px solid var(--border);
      margin-top: 14px;
      padding-top: 12px;
    }

    .btn-like {
      display: inline-flex; align-items: center; gap: 5px;
      background: none; border: 1.5px solid var(--border); border-radius: 20px;
      padding: 5px 14px; font-size: .9rem; cursor: pointer; font-weight: 600;
      color: var(--muted); transition: all .2s; font-family: inherit;
    }
    .btn-like:hover  { border-color: var(--accent); color: var(--accent); background: #fff0f4; }
    .btn-like.liked  { border-color: var(--accent); color: var(--accent); background: #fff0f4; }
    .btn-like .heart { font-size: 1rem; transition: transform .2s; }
    .btn-like.liked .heart { transform: scale(1.2); }

    .comment-toggle {
      display: inline-flex; align-items: center; gap: 5px;
      background: none; border: none; font-size: .9rem; cursor: pointer;
      font-weight: 600; color: var(--muted); transition: color .2s; font-family: inherit;
      padding: 5px 0;
    }
    .comment-toggle:hover { color: var(--primary); }

    /* Comments */
    .comment-section {
      padding: 0 18px 16px;
      display: none;
      flex-direction: column;
      gap: 10px;
    }
    .comment-section.open { display: flex; }

    .comment-list { display: flex; flex-direction: column; gap: 8px; }

    .comment-item {
      background: var(--bg);
      border-radius: 10px;
      padding: 9px 12px;
      font-size: .87rem;
    }
    .comment-item .c-author { font-weight: 700; color: var(--primary); margin-right: 6px; }
    .comment-item .c-text { color: var(--text); }
    .comment-item .c-time { font-size: .75rem; color: var(--muted); margin-top: 3px; }

    .no-comments { font-size: .85rem; color: var(--muted); text-align: center; padding: 6px 0; }

    .comment-name-row { display: flex; gap: 8px; }
    .comment-name-row input[type="text"] { max-width: 130px; flex-shrink: 0; }
    .btn-comment {
      background: var(--primary); color: #fff; border: none; border-radius: 10px;
      padding: 9px 16px; font-size: .88rem; cursor: pointer; font-weight: 700;
      white-space: nowrap; font-family: inherit; transition: opacity .2s;
    }
    .btn-comment:hover { opacity: .85; }
    .btn-comment:disabled { opacity: .5; cursor: not-allowed; }

    /* Empty state */
    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: var(--muted);
      grid-column: 1/-1;
    }
    .empty-state .emoji { font-size: 3.5rem; display: block; margin-bottom: 14px; }
    .empty-state p { font-size: 1.05rem; }

    /* Toast */
    #toast {
      position: fixed; bottom: 28px; left: 50%; transform: translateX(-50%) translateY(80px);
      background: #2d2d3a; color: #fff; padding: 12px 24px; border-radius: 30px;
      font-size: .93rem; font-weight: 600; opacity: 0; transition: all .35s; z-index: 999;
      white-space: nowrap; pointer-events: none;
    }
    #toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }

    @media (max-width: 520px) {
      header h1 { font-size: 1.5rem; }
      .upload-card { padding: 20px 16px; }
      .form-row { flex-direction: column; gap: 10px; }
    }
  </style>
</head>
<body>

<header>
  <h1>ğŸ¨ ìš°ë¦¬ ë°˜ ê°¤ëŸ¬ë¦¬</h1>
  <p>ë‚´ ì‘í’ˆì„ ì˜¬ë¦¬ê³ , ì¹œêµ¬ë“¤ì˜ ì‘í’ˆì— ì¢‹ì•„ìš”ì™€ ëŒ“ê¸€ì„ ë‚¨ê²¨ë´ìš”!</p>
</header>

<!-- Upload -->
<section class="upload-section">
  <div class="upload-card">
    <h2>âœï¸ ì‘í’ˆ ì˜¬ë¦¬ê¸°</h2>

    <div class="form-row">
      <div class="field">
        <label>ì´ë¦„</label>
        <input type="text" id="up-name" placeholder="í™ê¸¸ë™" maxlength="20" />
      </div>
      <div class="field">
        <label>ì œëª©</label>
        <input type="text" id="up-title" placeholder="ì‘í’ˆ ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”" maxlength="40" />
      </div>
    </div>

    <div style="margin-bottom:16px">
      <label>ì„¤ëª… (ì„ íƒ)</label>
      <textarea id="up-desc" placeholder="ì‘í’ˆì— ëŒ€í•´ ê°„ë‹¨íˆ ì ì–´ì£¼ì„¸ìš”..." maxlength="200"></textarea>
    </div>

    <div class="drop-zone" id="drop-zone">
      <input type="file" id="file-input" accept="image/*" />
      <div class="dz-icon">ğŸ–¼ï¸</div>
      <div class="dz-text">ì´ë¯¸ì§€ë¥¼ í´ë¦­í•˜ê±°ë‚˜ ì—¬ê¸°ì— ë“œë˜ê·¸í•˜ì„¸ìš”</div>
      <div class="dz-sub">JPG, PNG, GIF, WEBP ì§€ì› Â· ìµœëŒ€ 10MB</div>
    </div>

    <div id="preview-wrap">
      <img id="preview-img" src="" alt="ë¯¸ë¦¬ë³´ê¸°" />
    </div>

    <button class="btn btn-primary" id="btn-upload" disabled>ğŸš€ ì‘í’ˆ ì˜¬ë¦¬ê¸°</button>
  </div>
</section>

<!-- Gallery -->
<section class="gallery-section">
  <h2>ğŸ“¸ <span id="post-count">0</span>ê°œì˜ ì‘í’ˆ</h2>
  <div class="gallery-grid" id="gallery">
    <div class="empty-state"><span class="emoji">â³</span><p>ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p></div>
  </div>
</section>

<div id="toast"></div>

<script>
// â”€â”€ Helpers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function esc(str) {
  return String(str)
    .replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;')
    .replace(/"/g,'&quot;').replace(/'/g,'&#39;');
}

function formatDate(ts) {
  const d = new Date(ts);
  return `${d.getMonth()+1}/${d.getDate()} ${String(d.getHours()).padStart(2,'0')}:${String(d.getMinutes()).padStart(2,'0')}`;
}

let toastTimer;
function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  clearTimeout(toastTimer);
  toastTimer = setTimeout(() => t.classList.remove('show'), 2400);
}

// â”€â”€ Like state (localStorage â€“ per device) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function getLikeKey(id) { return 'like_' + id; }
function hasLiked(id)   { return localStorage.getItem(getLikeKey(id)) === '1'; }
function setLiked(id, v){ v ? localStorage.setItem(getLikeKey(id), '1') : localStorage.removeItem(getLikeKey(id)); }

// â”€â”€ API calls â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function api(path, opts = {}) {
  const res = await fetch(path, opts);
  if (!res.ok) {
    const err = await res.json().catch(() => ({ error: 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜' }));
    throw new Error(err.error || 'ì„œë²„ ì˜¤ë¥˜');
  }
  return res.json();
}

// â”€â”€ Upload logic â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let selectedFile = null;

const dropZone    = document.getElementById('drop-zone');
const fileInput   = document.getElementById('file-input');
const previewImg  = document.getElementById('preview-img');
const previewWrap = document.getElementById('preview-wrap');
const btnUpload   = document.getElementById('btn-upload');

function loadFile(file) {
  if (!file || !file.type.startsWith('image/')) { showToast('ì´ë¯¸ì§€ íŒŒì¼ë§Œ ì˜¬ë¦´ ìˆ˜ ìˆì–´ìš”!'); return; }
  if (file.size > 10 * 1024 * 1024) { showToast('íŒŒì¼ í¬ê¸°ëŠ” 10MB ì´í•˜ì—¬ì•¼ í•´ìš”!'); return; }
  selectedFile = file;
  const reader = new FileReader();
  reader.onload = e => {
    previewImg.src = e.target.result;
    previewWrap.style.display = 'block';
    checkReady();
  };
  reader.readAsDataURL(file);
}

fileInput.addEventListener('change', () => { if (fileInput.files[0]) loadFile(fileInput.files[0]); });
dropZone.addEventListener('dragover', e => { e.preventDefault(); dropZone.classList.add('over'); });
dropZone.addEventListener('dragleave', () => dropZone.classList.remove('over'));
dropZone.addEventListener('drop', e => {
  e.preventDefault(); dropZone.classList.remove('over');
  if (e.dataTransfer.files[0]) loadFile(e.dataTransfer.files[0]);
});

function checkReady() {
  const name  = document.getElementById('up-name').value.trim();
  const title = document.getElementById('up-title').value.trim();
  btnUpload.disabled = !(name && title && selectedFile);
}
document.getElementById('up-name').addEventListener('input', checkReady);
document.getElementById('up-title').addEventListener('input', checkReady);

btnUpload.addEventListener('click', async () => {
  const name  = document.getElementById('up-name').value.trim();
  const title = document.getElementById('up-title').value.trim();
  const desc  = document.getElementById('up-desc').value.trim();
  if (!name || !title || !selectedFile) return;

  btnUpload.disabled = true;
  btnUpload.innerHTML = '<span class="spinner"></span> ì—…ë¡œë“œ ì¤‘...';

  try {
    const fd = new FormData();
    fd.append('name',  name);
    fd.append('title', title);
    fd.append('desc',  desc);
    fd.append('image', selectedFile);

    await api('/api/posts', { method: 'POST', body: fd });

    // Reset form
    document.getElementById('up-name').value  = '';
    document.getElementById('up-title').value = '';
    document.getElementById('up-desc').value  = '';
    fileInput.value = '';
    selectedFile = null;
    previewWrap.style.display = 'none';
    previewImg.src = '';

    showToast('ğŸ‰ ì‘í’ˆì´ ì˜¬ë¼ê°”ì–´ìš”!');
    await renderGallery();
    document.querySelector('.gallery-section').scrollIntoView({ behavior: 'smooth', block: 'start' });
  } catch (err) {
    showToast('âŒ ' + err.message);
  } finally {
    btnUpload.innerHTML = 'ğŸš€ ì‘í’ˆ ì˜¬ë¦¬ê¸°';
    checkReady();
  }
});

// â”€â”€ Gallery â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderComments(comments) {
  if (!comments || comments.length === 0)
    return '<div class="no-comments">ëŒ“ê¸€ì´ ì—†ì–´ìš”. ì²« ëŒ“ê¸€ì„ ë‚¨ê²¨ë³´ì„¸ìš”!</div>';
  return comments.map(c => `
    <div class="comment-item">
      <span class="c-author">${esc(c.name)}</span><span class="c-text">${esc(c.text)}</span>
      <div class="c-time">${formatDate(c.created_at)}</div>
    </div>`).join('');
}

async function renderGallery() {
  const gallery = document.getElementById('gallery');
  try {
    const posts = await api('/api/posts');
    document.getElementById('post-count').textContent = posts.length;
    gallery.innerHTML = '';

    if (posts.length === 0) {
      gallery.innerHTML = `
        <div class="empty-state">
          <span class="emoji">ğŸ¨</span>
          <p>ì•„ì§ ì‘í’ˆì´ ì—†ì–´ìš”. ì²« ë²ˆì§¸ ì‘í’ˆì„ ì˜¬ë ¤ë³´ì„¸ìš”!</p>
        </div>`;
      return;
    }

    posts.forEach(post => {
      const liked = hasLiked(post.id);
      const card  = document.createElement('article');
      card.className = 'post-card';
      card.dataset.id = post.id;

      card.innerHTML = `
        <div class="post-img-wrap">
          <img src="${esc(post.imageSrc)}" alt="${esc(post.title)}" loading="lazy" />
        </div>
        <div class="post-body">
          <div class="post-meta">
            <span class="post-author">${esc(post.name)}</span>
            <span class="post-date">${formatDate(post.createdAt)}</span>
          </div>
          <div class="post-title">${esc(post.title)}</div>
          ${post.desc ? `<div class="post-desc">${esc(post.desc)}</div>` : ''}
          <div class="post-actions">
            <button class="btn-like${liked ? ' liked' : ''}" data-id="${post.id}">
              <span class="heart">${liked ? 'â¤ï¸' : 'ğŸ¤'}</span>
              <span class="like-count">${post.likeCount}</span>
            </button>
            <button class="comment-toggle" data-id="${post.id}">
              ğŸ’¬ ëŒ“ê¸€ ${post.comments.length > 0 ? post.comments.length : ''}
            </button>
          </div>
        </div>
        <div class="comment-section" id="cs-${post.id}">
          <div class="comment-list" id="cl-${post.id}">
            ${renderComments(post.comments)}
          </div>
          <div class="comment-name-row">
            <input type="text" class="c-name" placeholder="ì´ë¦„" maxlength="15" />
            <input type="text" class="c-text-input" placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•˜ì„¸ìš”..." maxlength="150" data-id="${post.id}" style="flex:1" />
            <button class="btn-comment" data-id="${post.id}">ë“±ë¡</button>
          </div>
        </div>`;

      gallery.appendChild(card);
    });
  } catch (err) {
    gallery.innerHTML = `<div class="empty-state"><span class="emoji">âš ï¸</span><p>ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨: ${esc(err.message)}</p></div>`;
  }
}

// â”€â”€ Event delegation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
document.getElementById('gallery').addEventListener('click', async e => {
  // Like
  const likeBtn = e.target.closest('.btn-like');
  if (likeBtn) {
    const id     = likeBtn.dataset.id;
    const liked  = hasLiked(id);
    const action = liked ? 'unlike' : 'like';
    likeBtn.disabled = true;
    try {
      const { likeCount } = await api(`/api/posts/${id}/like`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ action }),
      });
      setLiked(id, !liked);
      likeBtn.classList.toggle('liked', !liked);
      likeBtn.querySelector('.heart').textContent = liked ? 'ğŸ¤' : 'â¤ï¸';
      likeBtn.querySelector('.like-count').textContent = likeCount;
      showToast(liked ? 'ì¢‹ì•„ìš”ë¥¼ ì·¨ì†Œí–ˆì–´ìš”' : 'â¤ï¸ ì¢‹ì•„ìš”!');
    } catch (err) {
      showToast('âŒ ' + err.message);
    } finally {
      likeBtn.disabled = false;
    }
    return;
  }

  // Comment toggle
  const toggleBtn = e.target.closest('.comment-toggle');
  if (toggleBtn) {
    const id = toggleBtn.dataset.id;
    document.getElementById('cs-' + id)?.classList.toggle('open');
    return;
  }

  // Comment submit
  const commentBtn = e.target.closest('.btn-comment');
  if (commentBtn) {
    const id   = commentBtn.dataset.id;
    const card = document.querySelector(`.post-card[data-id="${id}"]`);
    const nameInput = card.querySelector('.c-name');
    const textInput = card.querySelector('.c-text-input');
    const name  = nameInput.value.trim();
    const text  = textInput.value.trim();
    if (!name) { showToast('ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!'); nameInput.focus(); return; }
    if (!text) { showToast('ëŒ“ê¸€ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!'); textInput.focus(); return; }

    commentBtn.disabled = true;
    try {
      const comment = await api(`/api/posts/${id}/comments`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ name, text }),
      });

      // Append comment to list
      const list = document.getElementById('cl-' + id);
      const noMsg = list.querySelector('.no-comments');
      if (noMsg) noMsg.remove();

      const div = document.createElement('div');
      div.className = 'comment-item';
      div.innerHTML = `<span class="c-author">${esc(comment.name)}</span><span class="c-text">${esc(comment.text)}</span><div class="c-time">${formatDate(comment.created_at)}</div>`;
      list.appendChild(div);

      // Update count
      const toggle = card.querySelector('.comment-toggle');
      const count  = list.querySelectorAll('.comment-item').length;
      toggle.textContent = `ğŸ’¬ ëŒ“ê¸€ ${count}`;

      nameInput.value = '';
      textInput.value = '';
      showToast('ğŸ’¬ ëŒ“ê¸€ì´ ë“±ë¡ëì–´ìš”!');
    } catch (err) {
      showToast('âŒ ' + err.message);
    } finally {
      commentBtn.disabled = false;
    }
    return;
  }
});

// Enter key in comment text field
document.getElementById('gallery').addEventListener('keydown', e => {
  if (e.key === 'Enter' && e.target.classList.contains('c-text-input')) {
    const id = e.target.dataset.id;
    document.querySelector(`.btn-comment[data-id="${id}"]`)?.click();
  }
});

// â”€â”€ Init â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
renderGallery();
</script>
</body>
</html>
